# 四、栈与队列

栈(stack)是限定仅在表尾进行插入和删除操作的线性表。

允许插入和删除的一端称为栈顶(top)，另一端称为栈底(bottom)，不含任何数据元素的栈称为空栈。栈又称为后进先出的线性表，简称LIFO结构。

## 4.4 栈的顺序存储结构及实现

### 4.4.1 栈的顺序存储结构

顺序栈是用数组来实现的。用下标为0的一端作为栈底，因为首元素存在栈底，变化最小。

top变量用来指示栈顶元素在数组中的位置。若存储栈的长度为StackSize，则栈顶位置top必须小于StackSize。当栈存在一个元素时，top等于0，通常把空栈的判定条件定为top等于-1。

顺序栈的进栈(push)和出栈(pop)时间复杂度都是O(1)。

## 4.5 两栈共享空间

前提是两栈具有相同数据类型。

栈1的栈底在数组始端，栈2的栈底在数组末端。

栈1为空时，top1=-1，栈2为空时，top2=n。

top1+1=top2说明栈满。

## 4.6 栈的链式存储结构及实现

### 4.6.1 栈的链式存储结构

栈的链式存储结构简称为链栈。链栈一般没有头结点，空栈时top=NULL。

链栈的进栈push和出栈pop时间复杂度均为O(1)。

若栈的使用过程中元素变化不可预料，有时很小，有时很大，就用链栈，反之若变化在可控范围内，则用顺序栈。

## 4.10 队列的定义

队列(queue)是只允许在一端进行插入操作，而在另一端进行删除操作的线性表。

队列是一种先进先出的线性表，简称FIFO。允许插入的一端称为队尾，允许删除的一端称为队头。

## 4.12 循环队列

队列顺序存储时入队列时间复杂度为O(1)，出列时间复杂度为O(n)。

若不限定队列的元素必须存储在数组的前n个单元，则出队性能会大大增加。

front指针指向队头元素，rear指针指向队尾元素的下一个位置，当front=real时，队列是空队列。

假溢出表示数组中队头前面还有空间，而数组末尾元素已经占用，再往后加数组越界的情况。

解决假溢出的方法是数组后面满了就从头开始，即头尾相接的循环。这种头尾相接的顺序存储结构称为循环队列。

这时会有新的问题，队列满的时候front也等于rear。因此队列满时需保留一个元素空间。

队列满的条件是(rear+1)%QueueSize == front

通用的计算队列长度的公式为：(real-front+QueueSize)%QueueSize

## 4.13 队列的链式存储结构及其实现

队列的链式存储结构，其实就是线性表的单链表，只不过它只能尾进头出而已，简称为链队列。

总之，在可以确定队列长度最大值的情况下，建议用循环队列，若无法预估队列长度，用链队列。

